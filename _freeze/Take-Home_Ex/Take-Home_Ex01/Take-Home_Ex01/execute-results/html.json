{
  "hash": "b24b5eccce040701355c7437af84992c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-Home Exercise 1\"\nauthor: \"Dexter Wan\"\ndate: \"September 5, 2024\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  freeze: true\n---\n\n\n## Background\n\nArmed conflict has been on the rise since about 2012, after a decline in the 1990s and early 2000s. First came conflicts in Libya, Syria and Yemen, triggered by the 2011 Arab uprisings. Libya’s instability spilled south, helping set off a protracted crisis in the Sahel region. A fresh wave of major combat followed: the 2020 Azerbaijani-Armenian war over the Nagorno-Karabakh enclave, horrific fighting in Ethiopia’s northern Tigray region that began weeks later, the conflict prompted by the Myanmar army’s 2021 power grab and Russia’s 2022 assault on Ukraine. Add to those 2023’s devastation in Sudan and Gaza. Around the globe, more people are dying in fighting, being forced from their homes or in need of life-saving aid than in decades.\n\nWe will be diving into the armed conflict in Myanmar, following the army's coup that lead to Myanmar's military rule in 2021, where Myanmar's previous leader, [Aung San Suu Kyi]{.underline}, was placed under arrest (Maizland, 2022). This has lead to civilian killings and arrest for those opposing the military, leading to over 10,000 detainees since the 2021 coup, according to a United Nation report (Farge & Mantovani, 2024). Specifically, we will be looking at the trends of violence shown in Myanmar and try to explain any patterns observed.\n\n## The Data\n\n### **Armed conflict data**\n\nFor the purpose of this assignment, armed conflict data of Myanmar between 2021-2024 from [Armed Conflict Location & Event Data (ACLED)](https://acleddata.com/), an independent, impartial, international non-profit organization collecting data on violent conflict and protest in all countries and territories in the world, is used.\n\n### GIS Data\n\nI have taken the Mynamar District Boundaries (Admin2) from <https://geonode.themimu.info/layers/geonode%3Ammr_polbnda_adm2_250k_mimu>\n\n## Importing Packages and Data\n\nBefore we start, we need to import the data and ensure we modify it as needed. Firstly, we start of by loading in the relevant packages that will be needed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, tidyverse, tmap, raster, spatstat, sparr, animation)\n```\n:::\n\n\nNow, we can load in our data. Let's start with the data from ACLED.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf = read_csv(\"data/raw/2021-01-01-2024-06-30-Southeast_Asia-Myanmar.csv\") %>%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326) %>%\n  st_transform(crs = 32647) %>%\n  mutate(event_date = dmy(event_date)) %>%\n  mutate(event_quarter = quarter(event_date)) %>%\n  mutate(event_year = year(event_date)) \n```\n:::\n\n\nAbove we have taken the data and transformed it into a **sf data frame** using st_as_sf, before transforming it to the projection of WGS 84 / UTM zone 47N, one of the projection CRS for Myanmar. I have also modified the event_date field to be in a Date format for R to recognise it as a date, before adding in 2 additional fields: the year of the event (event_year), and which quarter of the year the event takes place (event_quarter).\n\nNow, let us import the boundary data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmimu_sub = st_read(dsn = \"data/raw/MIMU_District_Admin2\",\n                   layer = \"mmr_polbnda_adm2_250k_mimu\") \n```\n:::\n\n\nNow we have the boundary data, but we need to verify its CRS.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(mimu_sub)\n```\n:::\n\n\nThe data is projected to 4326, which is the standard for WGS 84. We should project it to 32647 as well.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmimu_sub = st_transform(mimu_sub, crs = 32647)\n```\n:::\n\n\nIn order to preserve the CRS transformation and mutation of data, I shall write them into an rds file. This reduces the need to continually transform them every time this page is rendered.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(acled_sf, \"data/rds/acled_sf.rds\")\nwrite_rds(mimu_sub, \"data/rds/mimu_sub.rds\")\n```\n:::\n\n\nWith the files written, I can put \"eval: false\" on the above code chunks. From now on, we will simply need to read the rds files to obtain back the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf = read_rds(\"data/rds/acled_sf.rds\")\nmimu_sub = read_rds(\"data/rds/mimu_sub.rds\")\n```\n:::\n\n\n## Data Wrangling\n\n### Filtering Data\n\nFirstly, let us divide the ACLED data into its respective year and quarters. This is done through filtering the event_year and event_quarter\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf_21_Q1 = acled_sf %>% filter(event_year == 2021, event_quarter == 1)\nacled_sf_21_Q2 = acled_sf %>% filter(event_year == 2021, event_quarter == 2)\nacled_sf_21_Q3 = acled_sf %>% filter(event_year == 2021, event_quarter == 3)\nacled_sf_21_Q4 = acled_sf %>% filter(event_year == 2021, event_quarter == 4)\n\nacled_sf_22_Q1 = acled_sf %>% filter(event_year == 2022, event_quarter == 1)\nacled_sf_22_Q2 = acled_sf %>% filter(event_year == 2022, event_quarter == 2)\nacled_sf_22_Q3 = acled_sf %>% filter(event_year == 2022, event_quarter == 3)\nacled_sf_22_Q4 = acled_sf %>% filter(event_year == 2022, event_quarter == 4)\n\nacled_sf_23_Q1 = acled_sf %>% filter(event_year == 2023, event_quarter == 1)\nacled_sf_23_Q2 = acled_sf %>% filter(event_year == 2023, event_quarter == 2)\nacled_sf_23_Q3 = acled_sf %>% filter(event_year == 2023, event_quarter == 3)\nacled_sf_23_Q4 = acled_sf %>% filter(event_year == 2023, event_quarter == 4)\n\nacled_sf_24_Q1 = acled_sf %>% filter(event_year == 2024, event_quarter == 1)\nacled_sf_24_Q2 = acled_sf %>% filter(event_year == 2024, event_quarter == 2)\n```\n:::\n\n\nNow, for future reference, let us do a count of the types of events. The input \"sort = TRUE\" will arrange it in a descending order\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf %>% count(event_type, sort = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 6 features and 2 fields\nGeometry type: MULTIPOINT\nDimension:     XY\nBounding box:  xmin: -208804.4 ymin: 1103500 xmax: 640934.5 ymax: 3042960\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 6 × 3\n  event_type                     n                                      geometry\n* <chr>                      <int>                              <MULTIPOINT [m]>\n1 Explosions/Remote violence 12208 ((-208804.4 2357274), (-206931.7 2359490), (…\n2 Strategic developments     12126 ((-206931.7 2359490), (-201788.2 2366580), (…\n3 Battles                    12049 ((-207135 2358896), (-206931.7 2359490), (-2…\n4 Protests                    8829 ((-191409.1 2317222), (-174344.6 2321971), (…\n5 Violence against civilians  6225 ((-206931.7 2359490), (-204784 2358873), (-2…\n6 Riots                        116 ((-21578.24 2371638), (275.0944 2569257), (2…\n```\n\n\n:::\n:::\n\n\nAs we can see, out of the 6 event types, there seem to be less riots. As such, we will not be focusing as much on that and instead be focused more on the other 5 event types. I will import them as their own sf data frames.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprotests_sf = acled_sf %>% filter(event_type == \"Protests\")\nbattles_sf = acled_sf %>% filter(event_type == \"Battles\")\ndevelop_sf = acled_sf %>% filter(event_type == \"Strategic developments\")\nviolence_sf = acled_sf %>% filter(event_type == \"Violence against civilians\")\nexplosions_sf = acled_sf %>% filter(event_type == \"Explosions/Remote violence\")\n```\n:::\n\n\n### Creating ppp and owin objects\n\nIn order to use the data, we need to transform them into **ppp** objects.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp = as.ppp(acled_sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf): only first attribute column is used for marks\n```\n\n\n:::\n\n```{.r .cell-code}\nacled_ppp_21_Q1 = as.ppp(acled_sf_21_Q1)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf_21_Q1): only first attribute column is used for\nmarks\n```\n\n\n:::\n\n```{.r .cell-code}\nacled_ppp_21_Q2 = as.ppp(acled_sf_21_Q2)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf_21_Q2): only first attribute column is used for\nmarks\n```\n\n\n:::\n\n```{.r .cell-code}\nacled_ppp_21_Q3 = as.ppp(acled_sf_21_Q3)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf_21_Q3): only first attribute column is used for\nmarks\n```\n\n\n:::\n\n```{.r .cell-code}\nacled_ppp_21_Q4 = as.ppp(acled_sf_21_Q4)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf_21_Q4): only first attribute column is used for\nmarks\n```\n\n\n:::\n\n```{.r .cell-code}\nacled_ppp_22_Q1 = as.ppp(acled_sf_22_Q1)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf_22_Q1): only first attribute column is used for\nmarks\n```\n\n\n:::\n\n```{.r .cell-code}\nacled_ppp_22_Q2 = as.ppp(acled_sf_22_Q2)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf_22_Q2): only first attribute column is used for\nmarks\n```\n\n\n:::\n\n```{.r .cell-code}\nacled_ppp_22_Q3 = as.ppp(acled_sf_22_Q3)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf_22_Q3): only first attribute column is used for\nmarks\n```\n\n\n:::\n\n```{.r .cell-code}\nacled_ppp_22_Q4 = as.ppp(acled_sf_22_Q4)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf_22_Q4): only first attribute column is used for\nmarks\n```\n\n\n:::\n\n```{.r .cell-code}\nacled_ppp_23_Q1 = as.ppp(acled_sf_23_Q1)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf_23_Q1): only first attribute column is used for\nmarks\n```\n\n\n:::\n\n```{.r .cell-code}\nacled_ppp_23_Q2 = as.ppp(acled_sf_23_Q2)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf_23_Q2): only first attribute column is used for\nmarks\n```\n\n\n:::\n\n```{.r .cell-code}\nacled_ppp_23_Q3 = as.ppp(acled_sf_23_Q3)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf_23_Q3): only first attribute column is used for\nmarks\n```\n\n\n:::\n\n```{.r .cell-code}\nacled_ppp_23_Q4 = as.ppp(acled_sf_23_Q4)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf_23_Q4): only first attribute column is used for\nmarks\n```\n\n\n:::\n\n```{.r .cell-code}\nacled_ppp_24_Q1 = as.ppp(acled_sf_24_Q1)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf_24_Q1): only first attribute column is used for\nmarks\n```\n\n\n:::\n\n```{.r .cell-code}\nacled_ppp_24_Q2 = as.ppp(acled_sf_24_Q2)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(acled_sf_24_Q2): only first attribute column is used for\nmarks\n```\n\n\n:::\n:::\n\n\nNow, we will create the **owin** object using our boundary data, and attach it to the ppp objects.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmimu_sub_owin = as.owin(mimu_sub)\n\nmm_ppp_21_Q1 = acled_ppp_21_Q1[mimu_sub_owin] \nmm_ppp_21_Q2 = acled_ppp_21_Q2[mimu_sub_owin]\nmm_ppp_21_Q3 = acled_ppp_21_Q3[mimu_sub_owin]\nmm_ppp_21_Q4 = acled_ppp_21_Q4[mimu_sub_owin]\n\nmm_ppp_22_Q1 = acled_ppp_22_Q1[mimu_sub_owin] \nmm_ppp_22_Q2 = acled_ppp_22_Q2[mimu_sub_owin]\nmm_ppp_22_Q3 = acled_ppp_22_Q3[mimu_sub_owin]\nmm_ppp_22_Q4 = acled_ppp_22_Q4[mimu_sub_owin]\n\nmm_ppp_23_Q1 = acled_ppp_23_Q1[mimu_sub_owin] \nmm_ppp_23_Q2 = acled_ppp_23_Q2[mimu_sub_owin]\nmm_ppp_23_Q3 = acled_ppp_23_Q3[mimu_sub_owin]\nmm_ppp_23_Q4 = acled_ppp_23_Q4[mimu_sub_owin]\n\nmm_ppp_24_Q1 = acled_ppp_24_Q1[mimu_sub_owin] \nmm_ppp_24_Q2 = acled_ppp_24_Q2[mimu_sub_owin]\n```\n:::\n\n\nAs the data will be in meters, I will re-scale them to **km**, this is for the KDE layers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmm_ppp_21_Q1.km <- rescale.ppp(mm_ppp_21_Q1, 1000, \"km\")\nmm_ppp_21_Q2.km <- rescale.ppp(mm_ppp_21_Q2, 1000, \"km\")\nmm_ppp_21_Q3.km <- rescale.ppp(mm_ppp_21_Q3, 1000, \"km\")\nmm_ppp_21_Q4.km <- rescale.ppp(mm_ppp_21_Q4, 1000, \"km\")\n\nmm_ppp_22_Q1.km <- rescale.ppp(mm_ppp_22_Q1, 1000, \"km\")\nmm_ppp_22_Q2.km <- rescale.ppp(mm_ppp_22_Q2, 1000, \"km\")\nmm_ppp_22_Q3.km <- rescale.ppp(mm_ppp_22_Q3, 1000, \"km\")\nmm_ppp_22_Q4.km <- rescale.ppp(mm_ppp_22_Q4, 1000, \"km\")\n\nmm_ppp_23_Q1.km <- rescale.ppp(mm_ppp_23_Q1, 1000, \"km\")\nmm_ppp_23_Q2.km <- rescale.ppp(mm_ppp_23_Q2, 1000, \"km\")\nmm_ppp_23_Q3.km <- rescale.ppp(mm_ppp_23_Q3, 1000, \"km\")\nmm_ppp_23_Q4.km <- rescale.ppp(mm_ppp_23_Q4, 1000, \"km\")\n\nmm_ppp_24_Q1.km <- rescale.ppp(mm_ppp_24_Q1, 1000, \"km\")\nmm_ppp_24_Q2.km <- rescale.ppp(mm_ppp_24_Q2, 1000, \"km\")\n```\n:::\n\n\nNow, using the main ACLED data, we can check for duplicates.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(acled_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n:::\n\n\nThere seems to be no duplicates, which allows us to continue using the data and its subsets. I will grab a quarter and plot it out to see how it looks like.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(mm_ppp_21_Q1)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in default.charmap(ntypes, chars): Too many types to display every type\nas a different character\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Only 10 out of 3694 symbols are shown in the symbol map\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-15-1.png){width=1152}\n:::\n:::\n\n\nAs we can see, there is a lot of data for just 1 quarter. However, some patterns are already visible, such as the heavy amount of events happening in the centre of Myanmar. To get a better look of this, we should derive the KDE layers.\n\n## Computing KDE Layers\n\n### Testing Kernel Methods\n\nLet us compute the KDE for Myanmar's ACLED data using *bw.diggle*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkde_mm_21_Q1.bw = density(mm_ppp_21_Q1.km, sigma = bw.diggle, edge = TRUE, kernel = \"gaussian\")\nplot(kde_mm_21_Q1.bw)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-16-1.png){width=1152}\n:::\n:::\n\n\nThe data is not visible, using *bw.diggle* to get the bandwidth is not sufficient. We need to test out using a larger bandwidth. Here I attempt to use the *adaptive.density()* method:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmm_adaptive = adaptive.density(mm_ppp_21_Q1, method=\"kernel\")\nplot(mm_adaptive)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\nThe data is still not visible. we should find the larger sigma value using adaptive bandwidth methods.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkde_mm_21_Q1.ppl = density(mm_ppp_21_Q1.km, sigma = bw.ppl, edge = TRUE, kernel = \"gaussian\")\nkde_mm_21_Q1.CvL = density(mm_ppp_21_Q1.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\nkde_mm_21_Q1.scott = density(mm_ppp_21_Q1.km, sigma = bw.scott, edge = TRUE, kernel = \"gaussian\")\npar(mfrow=c(2,2))\nplot(kde_mm_21_Q1.ppl)\nplot(kde_mm_21_Q1.CvL)\nplot(kde_mm_21_Q1.scott)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-18-1.png){width=1152}\n:::\n:::\n\n\nWe do see more representation using *bw.scott()* and *bw.CvL()*, and I will elect to use the bw.CvL for the remaining KDE Layers for better clarity of the data.\n\n### Plotting monthly KDE Layers\n\nI shall use *bw.CvL()* for the remaining quarterly KDE layers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkde_mm_21_Q1.CvL = density(mm_ppp_21_Q1.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\nkde_mm_21_Q2.CvL = density(mm_ppp_21_Q2.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\nkde_mm_21_Q3.CvL = density(mm_ppp_21_Q3.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\nkde_mm_21_Q4.CvL = density(mm_ppp_21_Q4.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\npar(mfrow = c(2,2))\nplot(kde_mm_21_Q1.CvL)\nplot(kde_mm_21_Q2.CvL)\nplot(kde_mm_21_Q3.CvL)\nplot(kde_mm_21_Q4.CvL)\nmtext(\"Myanmar Conflict 2021\", side = 3, line = -2, outer = TRUE)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-19-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkde_mm_22_Q1.CvL = density(mm_ppp_22_Q1.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\nkde_mm_22_Q2.CvL = density(mm_ppp_22_Q2.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\nkde_mm_22_Q3.CvL = density(mm_ppp_22_Q3.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\nkde_mm_22_Q4.CvL = density(mm_ppp_22_Q4.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\npar(mfrow = c(2,2))\nplot(kde_mm_22_Q1.CvL)\nplot(kde_mm_22_Q2.CvL)\nplot(kde_mm_22_Q3.CvL)\nplot(kde_mm_22_Q4.CvL)\nmtext(\"Myanmar Conflict 2022\", side = 3, line = -1, outer = TRUE)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-20-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkde_mm_23_Q1.CvL = density(mm_ppp_23_Q1.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\nkde_mm_23_Q2.CvL = density(mm_ppp_23_Q2.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\nkde_mm_23_Q3.CvL = density(mm_ppp_23_Q3.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\nkde_mm_23_Q4.CvL = density(mm_ppp_23_Q4.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\npar(mfrow = c(2,2))\nplot(kde_mm_23_Q1.CvL)\nplot(kde_mm_23_Q2.CvL)\nplot(kde_mm_23_Q3.CvL)\nplot(kde_mm_23_Q4.CvL)\nmtext(\"Myanmar Conflict 2023\", side = 3, line = -2, outer = TRUE)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-21-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkde_mm_24_Q1.CvL = density(mm_ppp_24_Q1.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\nkde_mm_24_Q2.CvL = density(mm_ppp_24_Q2.km, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\")\npar(mfrow = c(1,2))\nplot(kde_mm_24_Q1.CvL)\nplot(kde_mm_24_Q2.CvL)\nmtext(\"Myanmar Conflict 2024\", side = 3, line = -2, outer = TRUE)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-22-1.png){width=1152}\n:::\n:::\n\n\n## 2nd Order Spatial Point Analysis\n\nBased on the observations above, we can see how there is high clustering of events occurring within Myanmar. This is particular around 2023, Q2, where events seem to be highly clustered around 2 areas. However, we see a further spread of such events across 2023, Q4, before it eventually starts to reduce in 2024. We should observe the movement of these events in 2 ways:\n\n1.  How much clustering do we see from 2023 Q2 to Q4? This will show the movement of events occurring,\n2.  What are the event types that are moving? This could help us visualise the pattern of attacks.\n\nOur second point can be visualised through spatio-temporal point pattern analysis. Now using 2nd order spatial point analysis, we can observe our first point. This will be done using G-Function. F-function will not give us a complete picture, while K and L-functions are too computationally expensive.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf %>% filter(event_year == 2023) %>% count(event_quarter)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 4 features and 2 fields\nGeometry type: MULTIPOINT\nDimension:     XY\nBounding box:  xmin: -206931.7 ymin: 1103500 xmax: 604775.1 ymax: 3027042\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 4 × 3\n  event_quarter     n                                                   geometry\n*         <int> <int>                                           <MULTIPOINT [m]>\n1             1  3368 ((-199243.8 2366471), (-191409.1 2317222), (-178063.2 229…\n2             2  2921 ((-191261.5 2351144), (-187696.5 2324700), (-174344.6 232…\n3             3  3200 ((-197883.4 2339678), (-196507.9 2341782), (-193232 23463…\n4             4  3753 ((-206931.7 2359490), (-204784 2358873), (-202989.4 23568…\n```\n\n\n:::\n:::\n\n\nBased on the count, we do see a growth in the number of events occuring from Q2 to Q4. Now, we shall calculate the envelope and see how the observed data compares. This will be done using G-Function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_mm_23_Q2.csr = envelope(mm_ppp_23_Q2.km, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2,  [3:29 remaining] 3,\n [3:31 remaining] 4,  [3:30 remaining] 5,  [3:27 remaining] 6,\n [3:25 remaining] 7,  [3:24 remaining] 8,  [3:22 remaining] 9,\n [3:24 remaining] 10,  [3:22 remaining] 11,  [3:19 remaining] 12,\n [3:16 remaining] 13,  [3:14 remaining] 14,  [3:12 remaining] 15,\n [3:09 remaining] 16,  [3:07 remaining] 17,  [3:04 remaining] 18,\n [3:01 remaining] 19,  [2:59 remaining] 20,  [2:56 remaining] 21,\n [2:54 remaining] 22,  [2:52 remaining] 23,  [2:50 remaining] 24,\n [2:47 remaining] 25,  [2:45 remaining] 26,  [2:42 remaining] 27,\n [2:40 remaining] 28,  [2:38 remaining] 29,  [2:35 remaining] 30,\n [2:33 remaining] 31,  [2:30 remaining] 32,  [2:28 remaining] 33,\n [2:26 remaining] 34,  [2:23 remaining] 35,  [2:21 remaining] 36,\n [2:19 remaining] 37,  [2:17 remaining] 38,  [2:15 remaining] 39,\n [2:12 remaining] 40,  [2:10 remaining] 41,  [2:08 remaining] 42,\n [2:05 remaining] 43,  [2:03 remaining] 44,  [2:01 remaining] 45,\n [1:58 remaining] 46,  [1:56 remaining] 47,  [1:54 remaining] 48,\n [1:52 remaining] 49,  [1:50 remaining] 50,  [1:47 remaining] 51,\n [1:45 remaining] 52,  [1:43 remaining] 53,  [1:41 remaining] 54,\n [1:38 remaining] 55,  [1:36 remaining] 56,  [1:34 remaining] 57,\n [1:32 remaining] 58,  [1:29 remaining] 59,  [1:27 remaining] 60,\n [1:25 remaining] 61,  [1:23 remaining] 62,  [1:21 remaining] 63,\n [1:19 remaining] 64,  [1:16 remaining] 65,  [1:14 remaining] 66,\n [1:12 remaining] 67,  [1:10 remaining] 68,  [1:08 remaining] 69,\n [1:05 remaining] 70,  [1:03 remaining] 71,  [1:01 remaining] 72,\n [59 sec remaining] 73,  [57 sec remaining] 74,  [54 sec remaining] 75,\n [52 sec remaining] 76,  [50 sec remaining] 77,  [48 sec remaining] 78,\n [46 sec remaining] 79,  [43 sec remaining] 80,  [41 sec remaining] 81,\n [39 sec remaining] 82,  [37 sec remaining] 83,  [35 sec remaining] 84,\n [33 sec remaining] 85,  [30 sec remaining] 86,  [28 sec remaining] 87,\n [26 sec remaining] 88,  [24 sec remaining] 89,  [22 sec remaining] 90,\n [20 sec remaining] 91,  [17 sec remaining] 92,  [15 sec remaining] 93,\n [13 sec remaining] 94,  [11 sec remaining] 95,  [9 sec remaining] 96,\n [7 sec remaining] 97,  [4 sec remaining] 98,  [2 sec remaining] \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nG_mm_23_Q3.csr = envelope(mm_ppp_23_Q3.km, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2,  [3:44 remaining] 3,\n [3:44 remaining] 4,  [3:40 remaining] 5,  [3:38 remaining] 6,\n [3:35 remaining] 7,  [3:32 remaining] 8,  [3:30 remaining] 9,\n [3:27 remaining] 10,  [3:25 remaining] 11,  [3:26 remaining] 12,\n [3:23 remaining] 13,  [3:20 remaining] 14,  [3:18 remaining] 15,\n [3:15 remaining] 16,  [3:13 remaining] 17,  [3:11 remaining] 18,\n [3:08 remaining] 19,  [3:06 remaining] 20,  [3:04 remaining] 21,\n [3:01 remaining] 22,  [2:59 remaining] 23,  [2:57 remaining] 24,\n [2:55 remaining] 25,  [2:53 remaining] 26,  [2:50 remaining] 27,\n [2:48 remaining] 28,  [2:45 remaining] 29,  [2:43 remaining] 30,\n [2:41 remaining] 31,  [2:38 remaining] 32,  [2:36 remaining] 33,\n [2:34 remaining] 34,  [2:31 remaining] 35,  [2:29 remaining] 36,\n [2:27 remaining] 37,  [2:25 remaining] 38,  [2:22 remaining] 39,\n [2:20 remaining] 40,  [2:18 remaining] 41,  [2:15 remaining] 42,\n [2:13 remaining] 43,  [2:11 remaining] 44,  [2:08 remaining] 45,\n [2:06 remaining] 46,  [2:04 remaining] 47,  [2:01 remaining] 48,\n [1:59 remaining] 49,  [1:57 remaining] 50,  [1:55 remaining] 51,\n [1:52 remaining] 52,  [1:50 remaining] 53,  [1:48 remaining] 54,\n [1:45 remaining] 55,  [1:43 remaining] 56,  [1:40 remaining] 57,\n [1:38 remaining] 58,  [1:36 remaining] 59,  [1:33 remaining] 60,\n [1:31 remaining] 61,  [1:29 remaining] 62,  [1:27 remaining] 63,\n [1:24 remaining] 64,  [1:22 remaining] 65,  [1:20 remaining] 66,\n [1:17 remaining] 67,  [1:15 remaining] 68,  [1:13 remaining] 69,\n [1:10 remaining] 70,  [1:08 remaining] 71,  [1:06 remaining] 72,\n [1:03 remaining] 73,  [1:01 remaining] 74,  [59 sec remaining] 75,\n [56 sec remaining] 76,  [54 sec remaining] 77,  [52 sec remaining] 78,\n [49 sec remaining] 79,  [47 sec remaining] 80,  [45 sec remaining] 81,\n [42 sec remaining] 82,  [40 sec remaining] 83,  [38 sec remaining] 84,\n [35 sec remaining] 85,  [33 sec remaining] 86,  [31 sec remaining] 87,\n [28 sec remaining] 88,  [26 sec remaining] 89,  [23 sec remaining] 90,\n [21 sec remaining] 91,  [19 sec remaining] 92,  [16 sec remaining] 93,\n [14 sec remaining] 94,  [12 sec remaining] 95,  [9 sec remaining] 96,\n [7 sec remaining] 97,  [5 sec remaining] 98,  [2 sec remaining] \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nG_mm_23_Q4.csr = envelope(mm_ppp_23_Q4.km, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2,  [4:23 remaining] 3,\n [4:18 remaining] 4,  [4:15 remaining] 5,  [4:12 remaining] 6,\n [4:11 remaining] 7,  [4:08 remaining] 8,  [4:07 remaining] 9,\n [4:10 remaining] 10,  [4:07 remaining] 11,  [4:03 remaining] 12,\n [4:00 remaining] 13,  [3:57 remaining] 14,  [3:54 remaining] 15,\n [3:51 remaining] 16,  [3:49 remaining] 17,  [3:46 remaining] 18,\n [3:42 remaining] 19,  [3:39 remaining] 20,  [3:38 remaining] 21,\n [3:35 remaining] 22,  [3:32 remaining] 23,  [3:29 remaining] 24,\n [3:26 remaining] 25,  [3:23 remaining] 26,  [3:20 remaining] 27,\n [3:17 remaining] 28,  [3:14 remaining] 29,  [3:11 remaining] 30,\n [3:09 remaining] 31,  [3:06 remaining] 32,  [3:04 remaining] 33,\n [3:01 remaining] 34,  [2:58 remaining] 35,  [2:55 remaining] 36,\n [2:52 remaining] 37,  [2:50 remaining] 38,  [2:47 remaining] 39,\n [2:44 remaining] 40,  [2:41 remaining] 41,  [2:38 remaining] 42,\n [2:36 remaining] 43,  [2:33 remaining] 44,  [2:30 remaining] 45,\n [2:28 remaining] 46,  [2:25 remaining] 47,  [2:22 remaining] 48,\n [2:19 remaining] 49,  [2:16 remaining] 50,  [2:14 remaining] 51,\n [2:11 remaining] 52,  [2:08 remaining] 53,  [2:05 remaining] 54,\n [2:03 remaining] 55,  [2:00 remaining] 56,  [1:57 remaining] 57,\n [1:54 remaining] 58,  [1:52 remaining] 59,  [1:49 remaining] 60,\n [1:46 remaining] 61,  [1:43 remaining] 62,  [1:41 remaining] 63,\n [1:38 remaining] 64,  [1:35 remaining] 65,  [1:32 remaining] 66,\n [1:30 remaining] 67,  [1:27 remaining] 68,  [1:24 remaining] 69,\n [1:21 remaining] 70,  [1:19 remaining] 71,  [1:16 remaining] 72,\n [1:13 remaining] 73,  [1:10 remaining] 74,  [1:08 remaining] 75,\n [1:05 remaining] 76,  [1:02 remaining] 77,  [1:00 remaining] 78,\n [57 sec remaining] 79,  [54 sec remaining] 80,  [52 sec remaining] 81,\n [49 sec remaining] 82,  [46 sec remaining] 83,  [43 sec remaining] 84,\n [41 sec remaining] 85,  [38 sec remaining] 86,  [35 sec remaining] 87,\n [33 sec remaining] 88,  [30 sec remaining] 89,  [27 sec remaining] 90,\n [24 sec remaining] 91,  [22 sec remaining] 92,  [19 sec remaining] 93,\n [16 sec remaining] 94,  [14 sec remaining] 95,  [11 sec remaining] 96,\n [8 sec remaining] 97,  [5 sec remaining] 98,  [3 sec remaining] \n99.\n\nDone.\n```\n\n\n:::\n:::\n\n\nNow let's plot the three quarter's G-values side-by-side.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1,3))\nplot(G_mm_23_Q2.csr)\nplot(G_mm_23_Q3.csr)\nplot(G_mm_23_Q4.csr)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-25-1.png){width=1152}\n:::\n:::\n\n\nAs expected, we do see more clustering in Q3 in the range of \\<500m, but Q2 and Q4 are generally around the same. Given the increase in the number of attacks across the three quarters, we could attribute Q4 to be an increase in the number of attacks instead, thus having the same relative G-value despite the KDE layer suggesting more dispersal.\n\n## Computing Spatio-Temporal KDE Layers\n\nNow let us look at the 5 event types individually for our Spatio-Temporal KDE.\n\n### Protests\n\nFirst, I shall filter them into individual years, then sort them by their quarters then convert them into **ppp** objects. This is to allow a ease of calculating the STKDE using *spattemp.density().* To ensure that the objects are created correctly, I will print the summary for the 2021 data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprotest_21_sf = protests_sf %>% filter(event_year == 2021) %>% dplyr::select(event_quarter)\nprotest_22_sf = protests_sf %>% filter(event_year == 2022) %>% dplyr::select(event_quarter)\nprotest_23_sf = protests_sf %>% filter(event_year == 2023) %>% dplyr::select(event_quarter)\nprotest_24_sf = protests_sf %>% filter(event_year == 2024) %>% dplyr::select(event_quarter)\nprotest_21_ppp = as.ppp(protest_21_sf)\nprotest_22_ppp = as.ppp(protest_22_sf)\nprotest_23_ppp = as.ppp(protest_23_sf)\nprotest_24_ppp = as.ppp(protest_24_sf)\nsummary(protest_21_ppp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMarked planar point pattern:  5934 points\nAverage intensity 4.188551e-09 points per square unit\n\n*Pattern contains duplicated points*\n\nCoordinates are given to 13 decimal places\n\nmarks are numeric, of type 'integer'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.000   1.000   2.000   1.826   2.000   4.000 \n\nWindow: rectangle = [-138595, 591875.9] x [1103500.1, 3042960.3] units\n                    (730500 x 1939000 units)\nWindow area = 1.41672e+12 square units\n```\n\n\n:::\n:::\n\n\nNow, I will attach the boundary data to the **ppp** objects, and calculate the STKDE.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprotest_21_owin = protest_21_ppp[mimu_sub_owin]\nprotest_22_owin = protest_22_ppp[mimu_sub_owin]\nprotest_23_owin = protest_23_ppp[mimu_sub_owin]\nprotest_24_owin = protest_24_ppp[mimu_sub_owin]\n\nprotest_21_st_kde= spattemp.density(protest_21_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nprotest_22_st_kde= spattemp.density(protest_22_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nprotest_23_st_kde= spattemp.density(protest_23_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nprotest_24_st_kde= spattemp.density(protest_24_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(protest_21_st_kde)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 59999.26 (spatial)\n  lambda = 0.0015 (temporal)\n\nNo. of observations\n  5934 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210008.6, 724647.6] x [1072026, 3158467]\n\nTemporal bound\n  [1, 4]\n\nEvaluation\n  128 x 128 x 4 trivariate lattice\n  Density range: [8.455845e-22, 3.141563e-09]\n```\n\n\n:::\n:::\n\n\nFinally, I shall plot out the individual quarters. I will utilise for-loops to print out the STKDE layers individually so that I can accurately label each layer.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(4,4))\nfor(i in c(1,2,3,4)){\n  plot(protest_21_st_kde, i, override.par = FALSE, main = paste(\"2021 - Q\", i))\n}\nfor(i in c(1,2,3,4)){\n  plot(protest_22_st_kde, i, override.par = FALSE, main = paste(\"2022 - Q\", i))\n} \nfor(i in c(1,2,3,4)){\n  plot(protest_23_st_kde, i, override.par = FALSE, main = paste(\"2023 - Q\", i))\n} \nfor(i in c(1,2)){\n  plot(protest_24_st_kde, i, override.par = FALSE, main = paste(\"2024 - Q\", i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-28-1.png){width=1152}\n:::\n:::\n\n\nNow, I shall repeat the process for the remaining 4 event types.\n\n### Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbattle_21_sf = battles_sf %>% filter(event_year == 2021) %>% dplyr::select(event_quarter)\nbattle_22_sf = battles_sf %>% filter(event_year == 2022) %>% dplyr::select(event_quarter)\nbattle_23_sf = battles_sf %>% filter(event_year == 2023) %>% dplyr::select(event_quarter)\nbattle_24_sf = battles_sf %>% filter(event_year == 2024) %>% dplyr::select(event_quarter)\nbattle_21_ppp = as.ppp(battle_21_sf)\nbattle_22_ppp = as.ppp(battle_22_sf)\nbattle_23_ppp = as.ppp(battle_23_sf)\nbattle_24_ppp = as.ppp(battle_24_sf)\nsummary(battle_21_ppp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMarked planar point pattern:  2234 points\nAverage intensity 1.665261e-09 points per square unit\n\n*Pattern contains duplicated points*\n\nCoordinates are given to 13 decimal places\n\nmarks are numeric, of type 'integer'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.000   2.000   3.000   2.957   4.000   4.000 \n\nWindow: rectangle = [-203795.3, 591875.9] x [1340466.9, 3026504.9] units\n                    (795700 x 1686000 units)\nWindow area = 1.34153e+12 square units\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbattle_21_owin = battle_21_ppp[mimu_sub_owin]\nbattle_22_owin = battle_22_ppp[mimu_sub_owin]\nbattle_23_owin = battle_23_ppp[mimu_sub_owin]\nbattle_24_owin = battle_24_ppp[mimu_sub_owin]\n\nbattle_21_st_kde= spattemp.density(battle_21_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nbattle_22_st_kde= spattemp.density(battle_22_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nbattle_23_st_kde= spattemp.density(battle_23_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nbattle_24_st_kde= spattemp.density(battle_24_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(battle_21_st_kde)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 69239.08 (spatial)\n  lambda = 0.0044 (temporal)\n\nNo. of observations\n  2234 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210008.6, 724647.6] x [1072026, 3158467]\n\nTemporal bound\n  [1, 4]\n\nEvaluation\n  128 x 128 x 4 trivariate lattice\n  Density range: [1.090743e-20, 4.67676e-10]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(4,4))\nfor(i in c(1,2,3,4)){\n  plot(battle_21_st_kde, i, override.par = FALSE, main = paste(\"2021 - Q\", i))\n} \nfor(i in c(1,2,3,4)){\n  plot(battle_22_st_kde, i, override.par = FALSE, main = paste(\"2022 - Q\", i))\n} \nfor(i in c(1,2,3,4)){\n  plot(battle_23_st_kde, i, override.par = FALSE, main = paste(\"2023 - Q\", i))\n} \nfor(i in c(1,2)){\n  plot(battle_24_st_kde, i, override.par = FALSE, main = paste(\"2024 - Q\", i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-31-1.png){width=1152}\n:::\n:::\n\n\n### Strategic Developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevelop_21_sf = develop_sf %>% filter(event_year == 2021) %>% dplyr::select(event_quarter)\ndevelop_22_sf = develop_sf %>% filter(event_year == 2022) %>% dplyr::select(event_quarter)\ndevelop_23_sf = develop_sf %>% filter(event_year == 2023) %>% dplyr::select(event_quarter)\ndevelop_24_sf = develop_sf %>% filter(event_year == 2024) %>% dplyr::select(event_quarter)\ndevelop_21_ppp = as.ppp(develop_21_sf)\ndevelop_22_ppp = as.ppp(develop_22_sf)\ndevelop_23_ppp = as.ppp(develop_23_sf)\ndevelop_24_ppp = as.ppp(develop_24_sf)\nsummary(develop_21_ppp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMarked planar point pattern:  3411 points\nAverage intensity 2.225079e-09 points per square unit\n\n*Pattern contains duplicated points*\n\nCoordinates are given to 13 decimal places\n\nmarks are numeric, of type 'integer'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.000   2.000   3.000   2.824   4.000   4.000 \n\nWindow: rectangle = [-198539.5, 591875.9] x [1103500.1, 3042960.3] units\n                    (790400 x 1939000 units)\nWindow area = 1.53298e+12 square units\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndevelop_21_owin = develop_21_ppp[mimu_sub_owin]\ndevelop_22_owin = develop_22_ppp[mimu_sub_owin]\ndevelop_23_owin = develop_23_ppp[mimu_sub_owin]\ndevelop_24_owin = develop_24_ppp[mimu_sub_owin]\n\ndevelop_21_st_kde= spattemp.density(develop_21_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\ndevelop_22_st_kde= spattemp.density(develop_22_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\ndevelop_23_st_kde= spattemp.density(develop_23_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\ndevelop_24_st_kde= spattemp.density(develop_24_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(develop_21_st_kde)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 64153.61 (spatial)\n  lambda = 0.0037 (temporal)\n\nNo. of observations\n  3411 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210008.6, 724647.6] x [1072026, 3158467]\n\nTemporal bound\n  [1, 4]\n\nEvaluation\n  128 x 128 x 4 trivariate lattice\n  Density range: [9.667345e-15, 5.292478e-10]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(4,4))\nfor(i in c(1,2,3,4)){\n  plot(develop_21_st_kde, i, override.par = FALSE, main = paste(\"2021 - Q\", i))\n} \nfor(i in c(1,2,3,4)){\n  plot(develop_22_st_kde, i, override.par = FALSE, main = paste(\"2022 - Q\", i))\n} \nfor(i in c(1,2,3,4)){\n  plot(develop_23_st_kde, i, override.par = FALSE, main = paste(\"2023 - Q\", i))\n} \nfor(i in c(1,2)){\n  plot(develop_24_st_kde, i, override.par = FALSE, main = paste(\"2024 - Q\", i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-34-1.png){width=1152}\n:::\n:::\n\n\n### Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nviolence_21_sf = violence_sf %>% filter(event_year == 2021) %>% dplyr::select(event_quarter)\nviolence_22_sf = violence_sf %>% filter(event_year == 2022) %>% dplyr::select(event_quarter)\nviolence_23_sf = violence_sf %>% filter(event_year == 2023) %>% dplyr::select(event_quarter)\nviolence_24_sf = violence_sf %>% filter(event_year == 2024) %>% dplyr::select(event_quarter)\nviolence_21_ppp = as.ppp(violence_21_sf)\nviolence_22_ppp = as.ppp(violence_22_sf)\nviolence_23_ppp = as.ppp(violence_23_sf)\nviolence_24_ppp = as.ppp(violence_24_sf)\nsummary(violence_21_ppp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMarked planar point pattern:  1877 points\nAverage intensity 1.254296e-09 points per square unit\n\n*Pattern contains duplicated points*\n\nCoordinates are given to 13 decimal places\n\nmarks are numeric, of type 'integer'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.000   2.000   3.000   2.968   4.000   4.000 \n\nWindow: rectangle = [-191409.1, 591875.9] x [1132472.1, 3042960.3] units\n                    (783300 x 1910000 units)\nWindow area = 1.49646e+12 square units\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nviolence_21_owin = violence_21_ppp[mimu_sub_owin]\nviolence_22_owin = violence_22_ppp[mimu_sub_owin]\nviolence_23_owin = violence_23_ppp[mimu_sub_owin]\nviolence_24_owin = violence_24_ppp[mimu_sub_owin]\n\nviolence_21_st_kde= spattemp.density(violence_21_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nviolence_22_st_kde= spattemp.density(violence_22_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nviolence_23_st_kde= spattemp.density(violence_23_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nviolence_24_st_kde= spattemp.density(violence_24_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(violence_21_st_kde)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 68873.22 (spatial)\n  lambda = 0.0052 (temporal)\n\nNo. of observations\n  1876 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210008.6, 724647.6] x [1072026, 3158467]\n\nTemporal bound\n  [1, 4]\n\nEvaluation\n  128 x 128 x 4 trivariate lattice\n  Density range: [2.295996e-17, 4.505932e-10]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(4,4))\nfor(i in c(1,2,3,4)){\n  plot(violence_21_st_kde, i, override.par = FALSE, main = paste(\"2021 - Q\", i))\n} \nfor(i in c(1,2,3,4)){\n  plot(violence_22_st_kde, i, override.par = FALSE, main = paste(\"2022 - Q\", i))\n} \nfor(i in c(1,2,3,4)){\n  plot(violence_23_st_kde, i, override.par = FALSE, main = paste(\"2023 - Q\", i))\n} \nfor(i in c(1,2)){\n  plot(violence_24_st_kde, i, override.par = FALSE, main = paste(\"2024 - Q\", i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-37-1.png){width=1152}\n:::\n:::\n\n\n### Explosions/Remote Violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexplosions_21_sf = explosions_sf %>% filter(event_year == 2021) %>% dplyr::select(event_quarter)\nexplosions_22_sf = explosions_sf %>% filter(event_year == 2022) %>% dplyr::select(event_quarter)\nexplosions_23_sf = explosions_sf %>% filter(event_year == 2023) %>% dplyr::select(event_quarter)\nexplosions_24_sf = explosions_sf %>% filter(event_year == 2024) %>% dplyr::select(event_quarter)\nexplosions_21_ppp = as.ppp(explosions_21_sf)\nexplosions_22_ppp = as.ppp(explosions_22_sf)\nexplosions_23_ppp = as.ppp(explosions_23_sf)\nexplosions_24_ppp = as.ppp(explosions_24_sf)\nsummary(explosions_21_ppp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMarked planar point pattern:  2704 points\nAverage intensity 1.918481e-09 points per square unit\n\n*Pattern contains duplicated points*\n\nCoordinates are given to 13 decimal places\n\nmarks are numeric, of type 'integer'\nSummary:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.000   2.000   3.000   3.097   4.000   4.000 \n\nWindow: rectangle = [-201788.2, 640934.5] x [1354010.7, 3026504.9] units\n                    (842700 x 1672000 units)\nWindow area = 1.40945e+12 square units\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nexplosions_21_owin = explosions_21_ppp[mimu_sub_owin]\nexplosions_22_owin = explosions_22_ppp[mimu_sub_owin]\nexplosions_23_owin = explosions_23_ppp[mimu_sub_owin]\nexplosions_24_owin = explosions_24_ppp[mimu_sub_owin]\n\nexplosions_21_st_kde= spattemp.density(explosions_21_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nexplosions_22_st_kde= spattemp.density(explosions_22_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nexplosions_23_st_kde= spattemp.density(explosions_23_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nexplosions_24_st_kde= spattemp.density(explosions_24_owin)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(explosions_21_st_kde)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 64684.59 (spatial)\n  lambda = 0.0033 (temporal)\n\nNo. of observations\n  2704 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210008.6, 724647.6] x [1072026, 3158467]\n\nTemporal bound\n  [1, 4]\n\nEvaluation\n  128 x 128 x 4 trivariate lattice\n  Density range: [2.09422e-34, 1.138173e-09]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(4,4))\nfor(i in c(1,2,3,4)){\n  plot(explosions_21_st_kde, i, override.par = FALSE, main = paste(\"2021 - Q\", i))\n} \nfor(i in c(1,2,3,4)){\n  plot(explosions_22_st_kde, i, override.par = FALSE, main = paste(\"2022 - Q\", i))\n} \nfor(i in c(1,2,3,4)){\n  plot(explosions_23_st_kde, i, override.par = FALSE, main = paste(\"2023 - Q\", i))\n} \nfor(i in c(1,2)){\n  plot(explosions_24_st_kde, i, override.par = FALSE, main = paste(\"2024 - Q\", i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-40-1.png){width=1152}\n:::\n:::\n\n\n## 2nd Order Spatio-Temporal Point Pattern Analysis\n\nBased on the 5 event types' Spatio-Temporal KDE layers, we can see a growing trend in Violence and Protests, while surprisingly a downwards trend for Battles, Strategic Developments and Explosions/Remote Violence. However, it is crucial to know if there is an actual decline in these three downwards trends, as it could be attributed to simply dispersal of events. We shall use G-Function to analyse this by comparing the 2024 Q2 results with the results from 2023 Q2, to see if over a year there is less clustering and overall less events occurring.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf %>% filter(event_year == 2023, event_quarter == 2) %>% count(event_type, sort = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 5 features and 2 fields\nGeometry type: MULTIPOINT\nDimension:     XY\nBounding box:  xmin: -191261.5 ymin: 1103500 xmax: 518300.4 ymax: 3006373\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 5 × 3\n  event_type                     n                                      geometry\n* <chr>                      <int>                              <MULTIPOINT [m]>\n1 Battles                      814 ((-174035.7 2284958), (-152179.1 2277258), (…\n2 Explosions/Remote violence   814 ((-191261.5 2351144), (-93596.16 2398133), (…\n3 Strategic developments       716 ((-187696.5 2324700), (-174344.6 2321971), (…\n4 Violence against civilians   401 ((-138595 2239402), (-120600.4 2242432), (-7…\n5 Protests                     176 ((275.0944 2569257), (21114.28 2358755), (70…\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf %>% filter(event_year == 2024, event_quarter == 2) %>% count(event_type, sort = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 5 features and 2 fields\nGeometry type: MULTIPOINT\nDimension:     XY\nBounding box:  xmin: -208804.4 ymin: 1103500 xmax: 597543.7 ymax: 3026505\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 5 × 3\n  event_type                     n                                      geometry\n* <chr>                      <int>                              <MULTIPOINT [m]>\n1 Explosions/Remote violence  1000 ((-208804.4 2357274), (-201925.4 2354103), (…\n2 Battles                      960 ((-201925.4 2354103), (-199243.8 2366471), (…\n3 Strategic developments       531 ((-197883.4 2339678), (-197577 2330794), (-1…\n4 Violence against civilians   297 ((-201925.4 2354103), (-197577 2330794), (-1…\n5 Protests                      42 ((-174344.6 2321971), (-138595 2239402), (-7…\n```\n\n\n:::\n:::\n\n\nBased on the count, we can observe the difference in the number of events for each of our 3 categories. Explosions/Remote Violence and Battles increased, while Strategic Developments saw a decrease. With this in mind, lets look at their G-function results. I shall filter out the relevant year and quarter for the 3 events, and convert them into **ppp** objects.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbattle_ppp_23_Q2 = battles_sf %>% filter(event_year == 2023, event_quarter == 2) %>% as.ppp()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(.): only first attribute column is used for marks\n```\n\n\n:::\n\n```{.r .cell-code}\nbattle_ppp_24_Q2 = battles_sf %>% filter(event_year == 2024, event_quarter == 2) %>% as.ppp()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(.): only first attribute column is used for marks\n```\n\n\n:::\n\n```{.r .cell-code}\ndevelop_ppp_23_Q2 = develop_sf %>% filter(event_year == 2023, event_quarter == 2) %>% as.ppp()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(.): only first attribute column is used for marks\n```\n\n\n:::\n\n```{.r .cell-code}\ndevelop_ppp_24_Q2 = develop_sf %>% filter(event_year == 2024, event_quarter == 2) %>% as.ppp()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(.): only first attribute column is used for marks\n```\n\n\n:::\n\n```{.r .cell-code}\nexplosions_ppp_23_Q2 = explosions_sf %>% filter(event_year == 2023, event_quarter == 2) %>% as.ppp()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(.): only first attribute column is used for marks\n```\n\n\n:::\n\n```{.r .cell-code}\nexplosions_ppp_24_Q2 = explosions_sf %>% filter(event_year == 2024, event_quarter == 2) %>% as.ppp()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(.): only first attribute column is used for marks\n```\n\n\n:::\n:::\n\n\nNow, I shall attach the boundary data to the **ppp** objects.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbattle_ppp_23_Q2 = battle_ppp_23_Q2[mimu_sub_owin]\nbattle_ppp_24_Q2 = battle_ppp_24_Q2[mimu_sub_owin]\n\ndevelop_ppp_23_Q2 = develop_ppp_23_Q2[mimu_sub_owin]\ndevelop_ppp_24_Q2 = develop_ppp_24_Q2[mimu_sub_owin]\n\nexplosions_ppp_23_Q2 = explosions_ppp_23_Q2[mimu_sub_owin]\nexplosions_ppp_24_Q2 = explosions_ppp_24_Q2[mimu_sub_owin]\n```\n:::\n\n\nFinally, lets calculate and plot out the G-function results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbattle_G_23_Q2.csr = envelope(battle_ppp_23_Q2, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nbattle_G_24_Q2.csr = envelope(battle_ppp_24_Q2, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\ndevelop_G_23_Q2.csr = envelope(develop_ppp_23_Q2, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\ndevelop_G_24_Q2.csr = envelope(develop_ppp_24_Q2, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nexplosions_G_23_Q2.csr = envelope(explosions_ppp_23_Q2, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nexplosions_G_24_Q2.csr = envelope(explosions_ppp_24_Q2, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(3,2))\nplot(battle_G_23_Q2.csr)\nplot(battle_G_24_Q2.csr)\n\nplot(develop_G_23_Q2.csr)\nplot(develop_G_24_Q2.csr)\n\nplot(explosions_G_23_Q2.csr)\nplot(explosions_G_24_Q2.csr)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-46-1.png){width=1152}\n:::\n:::\n\n\nFor Strategic Developments and Explosions/Remote Violence, we do see slightly less clustering, especially \\<500m. This aligns with our hypothesis that events are more dispersed across Myanmar, however, not by much. The surprise was the increase in clustering witnessed for Battles. This shows that there is both an increase in the number of events while still being highly concentrated around specific areas.\n\n## Plotting on OpenStreetMap\n\nI have attempted to plot the data onto OpenStreetMap. I convert the KDE data into **raster** and project it using the EPSG code 32647.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode(\"view\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\ntmap mode set to interactive viewing\n```\n\n\n:::\n\n```{.r .cell-code}\nkde_mm_24_Q2_CvL_raster = raster(kde_mm_24_Q2.CvL)\nprojection(kde_mm_24_Q2_CvL_raster) = CRS(\"+init=EPSG:32647\")\ntm_basemap(leaflet::providers$OpenStreetMap) +\n  tm_shape(kde_mm_24_Q2_CvL_raster) +\n  tm_raster(\"layer\") \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-1487691876c1d81f3553\" style=\"width:100%;height:270px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1487691876c1d81f3553\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"createMapPane\",\"args\":[\"tmap401\",401]},{\"method\":\"addProviderTiles\",\"args\":[\"OpenStreetMap\",null,\"OpenStreetMap\",{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addRasterImage\",\"args\":[\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFYAAADACAYAAACeaZSpAAAGo0lEQVR4nO2dP27cRhTGH9eB7AOkCASkMSDAVQqliGqXBnIEH0AH8Cl8AB1ARxDgUrVURLUAAy5VqTYcAV6mWM2G4s6QM+R8772ZeT/AkCxpSe6333zznySqiP7pru+f7nrp6yAi2khfQK100heQk7Fbu6NTsfdXjbBTESAhsEUBCBMWRBXCamkJDCk6Y1ME5c7ZKhyrkWKFTS3+7u+5YqPYKFgrEDoainWsdtQ71udM5zbNrlUpbKxg3dFpt1Rci4JCUeVY7oY+0rVqHKux97QGNcLWxi+SJ6/NpUNEhK1ZUIdFAQgTFkSzwloHoVDEOgiSFRjHoLeIY61VYCymSWE5SgxrxmqIAK5JxSYdywHLp4d2av946/159+tfu68CS4xEB2HWEhI09vdILApAFOvYOTdujs9FZ0eKdKx2UYkKFbYETFgQcGG5OwUaYoDIHAsDKmyrbiUCCqthXEASiwIQkKIjNTbg0BAJ5lgQJiyI5LGC7cNFvzk+77YPFz3RYbGTrrTG17N9uOjd8OEYdQuPnagHBwu8gdyEMtaJOrw+CVGJLApgZHUsEY9rYwawY66jmCjYHxQo7pSoS86LEteiAITqGYTYOSuuSjOF5GIwFwP7A0e+2bUTfmtFtSgoDFgUOCc6R6GmovvH27KjYL97WnCuPgRC2LURYVEAIupTCfX/tbg3t2NzVGirMnb4hhaJfH81/zfv/k4/7gpytRIsCkCsioKDv5tzbYxDfcy4VmMURDk2S/FYKura1yZiUaAcHmEZHbeGnN1bb6vAZWrKrUGC+ZpD1ImM1djrIrIogDHZjl09MTjh1qd/7vffH/35LnwMRrfmvFWqPwpGAyizF7SgczAppqPACHBYFICYjoJE52aDuUOQi2GlvyEi+vH5bf/j89tgviwebFnSz58p/lKiTuWv7272FgUgOqKdY90P3nz61m2vP+z+73GPzzGrxwgKLfo+XOuhuzx71Z+dvCYiot//+I2IBjV24A2P3yhqXLYUQX1NMYsCEJuPNz+7m6//+n8bKMJjh+auVCQrqVx0RESXZ696IqKzk9eHcUAUHQmOpdFQmphTvTGLAhB7xXNUYlMMXVyaM33MjR3se14fb352X08Ithq7BjGJ4gdjLApAvBD25PK7/9MoZAZAEweOPbn83r359K0jItq8/zJpey0LNtB0R6ed+xf7GosCEPErYe6vvK0DidV+vg5KbmCL4lwcEO0iYSoWOCMBca5xMWdbsGGkMyvs2KmhDcA1VGSpFdQUaY69v9pv+cxx8iWk5KnkUz4tCkCs+kR9O2g0dV2LcqybtgltS9KStZKiElkUwFi2l/b6Q+9aC9Jb7L3nFnYr0Qph3feb9186E/cQiwIQiz/VoWu1rQuQdivRknvCPAs67JFtrym4wIMbDaISWRTAWN0qePFz4Vua7M+lwLWLHBscQpyYwtHSceDCogBE9iIj0abVUPTHZHVs7G1NciN9dzofFgUgIEVo7NzWWgRE4NtDSYwV9E93vQZxLQpAFHXH45j1BBrcSlSIsKl3jNMgrkUBCPWOXdoVlr4BOuzkOcRdO74gKa5FAQiIsMguZooLtw8XvVQ3uyjHLi3aEuIWJWxJqG4VjCsv3zMOUo/JVaFldywyX1cXacZNKhYFILIKm8utoS7puBgnFWvmLVUqHesb+guJGC3u85qHFwtNgKgUtgay1ZCISitllCqlYhs+7AfVSoDMIKTcE3H8OsT1jOHoMFgUgMgeBWO3xrg3l1NjncjRScjm2OEeqeHXoeCh1+W6Bk1YFICACevbm4rYszpEetZgCPyxUz7xuIq/5B4IiwIQaopOTrhaIVM05VjOFkhTwnLSRBRItJXNsSBMWBAmLIgqhe0fb3fjFM+zvBJ7FKoUVgNVtgqI/EOInGMJ1QpLJCuuRQGI5oTlWiDXnLBE/keY5KZJYTmoWti5igrp3KqFlcSEBWHCEqbL24Swm+PzLiZvs54z58GM/6le2LFTuabEqxd2COc6g6aE5aTq0S0foUoq94Rjc8IS8YhrUQDChAXRjLDcE4rNCMtNlcIudWfOYcQqhR3W7kOhOOOgSmE1UHU71rcnN8a1OdqzVQsbIjYS1ghsUQCiKWFdrW97EDKRugU1B00IK0GzwqLjoIlWQWqzyx6fqpgmhJXYjtREFITwxYHMc2mNaJp0LNeEYtWERHS9MFvGWRjNWZ9rA3NTwnLuCrcoAGHCGnng2IpEZI6FYcIaeeBaW2CONZah8QmghqGP/wCrwNq3w5SgkgAAAABJRU5ErkJggg==\",[[0.02848765641790799,94.50937409898997],[0.009658123661513789,94.51780816104235]],1,null,\"tmap401\",\"kde_mm_24_Q2_CvL_raster\"]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#FFFACE\",\"#FEE697\",\"#FEBE4A\",\"#F88B22\",\"#DB5D0A\",\"#A33803\"],\"labels\":[\"0.000 to 0.005\",\"0.005 to 0.010\",\"0.010 to 0.015\",\"0.015 to 0.020\",\"0.020 to 0.025\",\"0.025 to 0.030\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":1,\"position\":\"topright\",\"type\":\"unknown\",\"title\":\"layer\",\"extra\":null,\"layerId\":\"legend401\",\"className\":\"info legend kde_mm_24_Q2_CvL_raster\",\"group\":\"kde_mm_24_Q2_CvL_raster\"}]},{\"method\":\"addLayersControl\",\"args\":[[],\"kde_mm_24_Q2_CvL_raster\",{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topleft\"}]}],\"limits\":{\"lat\":[0.009658123661513789,0.02848765641790799],\"lng\":[94.50937409898997,94.51780816104235]},\"fitBounds\":[0.009668982793476229,94.50937409898998,0.02848765641791984,94.51774819623485,[]]},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n```{.r .cell-code}\ntmap_mode(\"plot\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\ntmap mode set to plotting\n```\n\n\n:::\n:::\n\n\nI am unsure why the coordinates are not matching.\n\n## Observations\n\nFirstly, we can come to the conclusion that majority of the fight occurs in the northern and southern part of Myanmar. However, one thing interesting is the lack of events occurring near the center. Ann San Suu Kyi was arrested and kept in **Nay Pyi Taw** (Maizland, 2021), the capital of Myanmar, where she seems to have remained after moving from prison to house arrest in 2024 (Ratcliffe, 2024).\n\n[![A Map of Myanmar, taken from Council on Foreign Relations (CFR)](images/clipboard-1508579045.png)](https://www.cfr.org/backgrounder/myanmar-history-coup-military-rule-ethnic-conflict-rohingya#chapter-title-0-2)\n\nYet the fighting seems to be away from this particular city. Usually we would expect demonstrations to occur near the parliament of the country, and given that Suu Kyi was arrested there, it would make sense for resistance forces to attempt to pressure the government by creating havoc near the official's buildings. However, there could be a reason for this, and this is highlighted from 2024 Q2.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,2))\nplot(kde_mm_24_Q2.CvL)\nplot(violence_24_st_kde, 2, override.par = FALSE, main = paste(\"2024 - Q\", i))\nplot(explosions_24_st_kde, 2, override.par = FALSE, main = paste(\"2024 - Q\", i))\nplot(battle_24_st_kde, 2, override.par = FALSE, main = paste(\"2024 - Q\", i))\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_files/figure-html/unnamed-chunk-48-1.png){width=1152}\n:::\n:::\n\n\n[![A map of Myanmar highlighting the military and militias presence, taken from The Economist](images/clipboard-3117419048.png)](https://www.economist.com/asia/2024/05/16/the-military-dictatorship-controls-less-than-50-of-myanmar)\n\nThere is a clear correlation between the presence of the Militias, Myanmar's multiple civil resistance groups, and the presence of events, particularly violent events such as explosions, battles and violence against civilians. The presence of these events suggests violent fighting within these areas.\n\nFurthermore, the opposition has expanded and gained ground since late 2023 (The Economist, 2024). This would also suggest why we see the spread coverage despite the non-reduction in the number of events.\n\n### So what can we hope for Myanmar in the future?\n\nWe do see an upward trend of fighting, and its unlikely that it will end anytime soon. However, we do see some silver lining.\n\nThe increased spread in fighting, while bad, does signal that the military, Junta, is spread thin more than ever, and that the resistance does seem to be gaining ground. As Mr Dustin Barter, a senior research fellow at Global Affairs Think Tank ODI, told Channel News Asia (CNA), \"In the past few months, there has been a lot of gains by the revolution and the resistance. There is optimism and hope that the military can be ousted.\" (Leong & Ng, 2024).\n\n## References\n\nFarge, E., & Mantovani, C. (2024, September 17). Myanmar Military stepping up civilian killings and arrests, says UN report. *Reuters*. <https://www.reuters.com/world/asia-pacific/myanmar-military-intensifies-civilian-killings-arrests-says-un-report-2024-09-17/>\n\nMaizland, L. (2022, January 31). Myanmar's Troubled History: Coups, Military Rule, and Ethnic Conflict. *Council on Foreign Relations.* <https://www.cfr.org/backgrounder/myanmar-history-coup-military-rule-ethnic-conflict-rohingya>\n\nLeong, W. K., & Ng, D. (2024, February 1). CNA Explains: What's happened since Myanmar's coup 3 years ago? *Channel News Asia.* <https://www.channelnewsasia.com/asia/myanmar-coup-3-years-anniversary-cna-explains-timeline-junta-4091861>\n\nRatcliffe, R. (2024, April 17). Aung San Suu Kyi, Myanmar's jailed former leader, moved to house arrest, says junta. *The Guardian.* <https://www.theguardian.com/world/2024/apr/17/aung-san-suu-kyi-myanmar-jailed-former-leader-moved-to-house-arrest-says-junta>\n\nThe Economist. (2024, May 16). *The military dictatorship controls less than 50% of Myanmar.* <https://www.economist.com/asia/2024/05/16/the-military-dictatorship-controls-less-than-50-of-myanmar>\n",
    "supporting": [
      "Take-Home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/leaflet-1.3.1/leaflet.js\"></script>\n<link href=\"../../site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/proj4-2.6.2/proj4.min.js\"></script>\n<script src=\"../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\n<link href=\"../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/leaflet-binding-2.2.2/leaflet.js\"></script>\n<script src=\"../../site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js\"></script>\n<script src=\"../../site_libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}